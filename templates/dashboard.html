<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dashboard â€” Secure File Transfer</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body class="page-body">
  <div class="container">
    <header class="header">
      <a class="brand" href="{{ url_for('index') }}">
        <div class="logo">SF</div>
        <div><h1>Secure File Transfer</h1></div>
      </a>
      <nav class="nav">
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('logout') }}">Logout</a>
      </nav>
    </header>

    <div class="grid">
      <main>
        <div class="card">
          <h2>Upload a file</h2>

          <!-- GIF Animation near upload -->
    

          <form action="{{ url_for('upload') }}" method="post"
                enctype="multipart/form-data" class="upload-area">
            <input type="file" name="file" required>
            <button class="btn" type="submit">Upload Securely</button>
          </form>

          <div class="files-list">
            <h3>Your files</h3>
            {% for f in files %}
              <div class="file-row">
                <div class="file-meta">
                  <div class="file-icon">F</div>
                  <div>
                    <div class="file-name">{{ f.filename_orig }}</div>
                    <div class="file-sub">
                      Uploaded: {{ f.created_at.strftime('%Y-%m-%d %H:%M') if f.created_at else '' }}
                    </div>
                  </div>
                </div>
                <div class="file-actions">
                  <a class="btn ghost" href="{{ url_for('download', file_id=f.id) }}">Download</a>
                  <form class="share-form"
                        action="{{ url_for('share', file_id=f.id) }}"
                        method="post">
                    <input type="text" name="recipient"
                           placeholder="username to share" required>
                    <button class="btn" type="submit">Share</button>
                  </form>
                </div>
              </div>
            {% else %}
              <div class="file-row">
                <div class="file-name">No files uploaded yet.</div>
              </div>
            {% endfor %}
          </div>
        </div>
      </main>

      <aside class="side">
        <div class="card info">
          <h3>Files shared with you</h3>
          <div class="shared-list">
            {% for item in shared %}
              <div class="shared-item">
                <div>
                  {{ item.file.filename_orig }}
                  <div class="file-sub">from {{ item.sender }}</div>
                </div>
                <a class="btn ghost" href="{{ url_for('download', file_id=item.file.id) }}">Download</a>
              </div>
            {% else %}
              <div class="shared-item">No files shared with you yet.</div>
            {% endfor %}
          </div>
        </div>
      </aside>
    </div>
  </div>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="flash">{{ messages[0] }}</div>
    {% endif %}
  {% endwith %}
</body>
</html>
